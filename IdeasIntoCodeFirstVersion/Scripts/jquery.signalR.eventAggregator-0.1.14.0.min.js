(function(b){b.EventAggregator=function(c){if(c){this.proxy=new a(this);}};b.EventAggregator.prototype=function(){function c(f,e){var d=e?f.constructor:f;if(d.__subscribers===undefined){d.__subscribers=[];}return d.__subscribers;}return{unsubscribe:function(d){$.each(d.__subscribedMessages,function(){var e=-1;for(var f=0;f<this.__subscribers.length;f++){if(this.__subscribers[f].context==d){e=f;break;}}if(e!=-1){this.__subscribers.splice(e,1);}});if(this.proxy){this.proxy.unsubscribe(d.__subscribedMessages);}},subscribe:function(h,f,e,d){if(e.__subscribedMessages===undefined){e.__subscribedMessages=[];}e.__subscribedMessages.push(h);var g=c.call(this,h,false);g.push({handler:f,context:e});if(this.proxy){this.proxy.subscribe(h,d);}},publish:function(d){var e=c.call(this,d,true);$.each(e,function(){this.handler.call(this.context,d);});}};}();var a=function(c){this.eventAggregator=c;this.hub=$.connection.eventAggregatorProxyHub;this.hub.client.onEvent=this.onEvent.bind(this);this.started=false;this.quedSubscriptions=[];$.connection.hub.start().done(this.onStarted.bind(this));};a.prototype={onStarted:function(){this.started=true;$.each(this.quedSubscriptions,function(c,d){this.subscribe(d.eventType,d.constraint);}.bind(this));},onEvent:function(e){var f=b.getEvent(e.type);var c=new f();for(var d in e.event){c[d]=e.event[d];}this.eventAggregator.publish(c);},subscribe:function(d,c){if(d.proxyEvent!==true){return;}if(this.started===false){this.quedSubscriptions.push({eventType:d,constraint:c});}else{this.hub.server.subscribe(d.type,c);}},unsubscribe:function(c){var d=$.map(c,function(e){return e.type;});this.hub.server.unsubscribe(d);}};b.eventAggregator=new b.EventAggregator(true);})(window.signalR=window.signalR||{});